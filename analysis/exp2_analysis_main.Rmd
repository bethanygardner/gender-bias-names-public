---
title: 'Experiment 2: Main Analysis'
author: "Bethany Gardner"
date: "05/05/2022"
output: 
  pdf_document:
    toc: true
    toc_depth: 3
  github_document:
    toc: true
    toc_depth: 3
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(lme4)
library(lmerTest)
library(broom.mixed)
library(knitr)
```

# Setup

Load data and select columns used in model. See data/exp2_data_about.txt
for more details.

```{r}
d <- read.csv("../data/exp2_data.csv", stringsAsFactors=TRUE) %>%
  rename("Participant"="SubjID", "Item"="NameShown") %>%
  select(Participant, Condition, GenderRating, Item, Male, Female, Other)
str(d)
```

Center gender rating for names: Original scale from 1 to 7, with 1 as
most masculine and 7 as most feminine. Mean-centered with higher still
as more feminine.

```{r}
d %<>% mutate(GenderRatingCentered=scale(d$GenderRating, scale=FALSE))
```

Set contrasts for name conditions.

```{r}
contrasts(d$Condition) = cbind("last vs first/full"=c(.33,.33,-0.66), 
                               "first vs full"=c(-.5,.5,0))
contrasts(d$Condition)
```

Subset for gender rating effects (First and Full conditions only).

```{r}
d.FF <- d %>% filter(Condition!="last") 
d.FF$Condition <- droplevels(d.FF$Condition)
contrasts(d.FF$Condition) = cbind("first vs full"=c(-.5,.5)) #add contrast back
contrasts(d.FF$Condition)
```

# Data Summary

Responses by condition.

```{r}
d %<>% mutate(ResponseAll=case_when(
              Male==1 ~ "Male",
              Female==1 ~ "Female", 
              Other==1 ~ "Other"))

d.count_responses <- d %>% group_by(Condition, ResponseAll) %>%
  summarise(n=n()) %>%
  pivot_wider(names_from=ResponseAll,
              values_from=n) %>%
  mutate(Female_MaleOther = Female / (Male+Other),
         Female_Male = Female / Male)

kable(d.count_responses, digits=3)
```

-   First name condition has most *female* responses
-   Full name condition has second-most *female* responses
-   Last name condition has fewest *female* responses

# Model 1: Condition

Effect of Condition (first name, last name, full name) on likelihood of
a *female* response, as opposed to a *male* or *other* response.
Participant and Item are included as random intercepts, with items
defined as the unique first, last and first + last name combinations.
Because the condition manipulations were fully between-subject and
between-item, fitting a random slope model was not possible.

```{r}
m.cond <- glmer(Female ~ Condition + (1|Participant) + (1|Item), 
            data=d, family=binomial)
m.cond_tidy <- tidy(m.cond)
summary(m.cond)
```

-   Less likely overall to recall character as female.

-   Less likely to recall character as female in the Last Name condition
    as compared to the First and Full Name conditions.

## Convert to Odds Ratios

**Intercept**

```{r}
m.cond_intercept <- m.cond_tidy %>% 
  filter(term=="(Intercept)") %>%
  select(estimate) %>% as.numeric()

exp(m.cond_intercept)
exp(-m.cond_intercept)
```

0.41x less likely to recall as female overall. Easier to interpret:
2.41x more likely to recall as male/other overall.

**Condition: Last vs First+Full**

```{r}
m.cond_LFF <- m.cond_tidy %>% 
  filter(term=="Conditionlast vs first/full") %>%
  select(estimate) %>% as.numeric()
exp(m.cond_LFF)
```

7.29x more likely to recall as female in First + Full compared to Last.
--> 7.29 more likely to recall as male in Last than in First + Full.

**Condition: Last Only**

Dummy code with Last Name as 0, so that intercept is the Last Name
condition only.

```{r}
d %<>% mutate(Condition_Last=case_when(
  Condition=="first" ~ 1,
  Condition=="full" ~ 1,
  Condition=="last" ~ 0))
d$Condition_Last %<>% as.factor()

```

```{r}
m.last <- glmer(Female ~ Condition_Last + (1|Participant) + (1|Item), 
          data=d, family=binomial)
m.last_tidy <- tidy(m.last)
```

```{r}
m.cond_last <- m.last_tidy %>% 
  filter(term=="(Intercept)") %>%
  select(estimate) %>% as.numeric()

exp(m.cond_last)
exp(-m.cond_last)
```
0.11x times less likely to recall as female in the Last Name condition --> 8.94x more likely to recall as male in the Last Name condition.

**Condition: First and Full Only**

Dummy code with First and Full Name as 0, so that intercept is average for these two conditions.

```{r}
d %<>% mutate(Condition_FF=case_when(
  Condition=="first" ~ 0,
  Condition=="full" ~ 0,
  Condition=="last" ~ 1))
d$Condition_FF %<>% as.factor()
```

```{r}
m.ff <- glmer(Female ~ Condition_FF + (1|Participant) + (1|Item), 
          data=d, family=binomial)
m.ff_tidy <- tidy(m.ff)
```

```{r}
m.cond_ff <- m.ff_tidy %>% 
  filter(term=="(Intercept)") %>%
  select(estimate) %>% as.numeric()

exp(m.cond_ff)
exp(-m.cond_ff)
```
0.75x times less likely to recall characters as female in the First and Full Name conditions --> 1.32x more likely to use recall characters as male in the First and Full Name conditions.

# Model 2: Condition \* Name Gender

Effects of Condition (first name, full name) and the first name's Gender
Rating (centered, positive=more feminine) on the likelihood of a
*female* response, as opposed to a *male* or *other* response. In
Experiment 2, the Last Name condition does not include any instances of
the gendered first name, so it is not included here. Participant and
Item are again included as random intercepts.

```{r}
m.namegender <- glmer(Female ~ Condition * GenderRatingCentered + 
            (1|Participant) + (1|Item), 
            data=d.FF, family=binomial)
m.namegender_tidy <- tidy(m.namegender)
summary(m.namegender)
```

-   Less likely overall to recall character as female in the First and
    Full Name conditions.

-   Somewhat more likely to recall the character as female in the First
    Name condition as compared to the Full Name condition (trending).

-   More likely to recall character as female as first name becomes more
    feminine.

-   No interaction between name condition and first name gender rating.
